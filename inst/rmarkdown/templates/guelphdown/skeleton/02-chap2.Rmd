---
output:
  pdf_document: default
  html_document: default

---

```{r package_loading_int_c2, include=F}
#devtools::install_github(repo = 'sciarraseb/nonlinSimsAnalysis', force = T)
library(easypackages)
packages <- c('tidyverse', 'RColorBrewer', 'parallel', 'data.table', 'kableExtra', 'ggtext', 'egg', 'ggbrace', 'cowplot', 'nonlinSimsAnalysis', 'nonlinSims')
libraries(packages)

knitr::opts_chunk$set(message = F)
```

```{r knitting_setup_int_c2, echo=F, message = F, warning = F}
#import raw data files (needed for computing variances)
exp_1_raw <- nonlinSimsAnalysis:::convert_raw_var_to_sd(raw_data = read_csv('data/exp_1_data.csv')) %>%
  mutate_at(.vars = c("number_measurements", "measurement_spacing", "midpoint"), factor)

exp_2_raw <-nonlinSimsAnalysis:::convert_raw_var_to_sd(raw_data = read_csv('data/exp_2_data.csv')) %>%
  mutate_at(.vars = c("number_measurements", "measurement_spacing", "sample_size"), factor)

exp_3_raw <-nonlinSimsAnalysis:::convert_raw_var_to_sd(raw_data = read_csv('data/exp_3_data.csv')) %>%
  mutate_at(.vars = c("number_measurements", "time_structuredness", "sample_size"), factor)

#unfiltered data 
param_summary_exp_1 <- readRDS(file = 'data/uf_param_summary_exp_1.RData')
param_summary_exp_2 <- readRDS(file = 'data/uf_param_summary_exp_2.RData')
param_summary_exp_3 <- readRDS(file = 'data/uf_param_summary_exp_3.RData')

#create analytical versions of summary data + converts vars to sds
exp_1_analytical <- generate_likert_days_data_sets(summary_data = param_summary_exp_1, exp_num = '1')
exp_2_analytical <- generate_likert_days_data_sets(summary_data = param_summary_exp_2, exp_num = '2')
exp_3_analytical <- generate_likert_days_data_sets(summary_data = param_summary_exp_3, exp_num = '3')

combined_analytical_exp_1 <- rbind(exp_1_analytical$likert, exp_1_analytical$days)
combined_analytical_exp_2 <- rbind(exp_2_analytical$likert, exp_2_analytical$days)
combined_analytical_exp_3 <- rbind(exp_3_analytical$likert, exp_3_analytical$days)

#create condition summary data sets 
cond_summary_exp_1 <- compute_condition_summary(param_summary_data = combined_analytical_exp_1, facet_var = 'measurement_spacing', 
                          ind_vars = c('number_measurements', 'measurement_spacing', 'midpoint'))
cond_summary_exp_2 <- compute_condition_summary(param_summary_data = combined_analytical_exp_2, facet_var = 'measurement_spacing', 
                  ind_vars = c('number_measurements', 'measurement_spacing', 'sample_size'))

cond_summary_exp_3 <- compute_condition_summary(param_summary_data = combined_analytical_exp_3, facet_var = 'time_structuredness', 
                          ind_vars = c('number_measurements', 'sample_size', 'time_structuredness'))
```

```{r pre_knitting_setup_unfiltered_int_c2, echo=F, eval=F, include=F}
#code should be computed before knitting to decrease knitting time 
#load data from experiments
exp_1 <- read_csv(file = 'data/exp_1_data.csv') %>% filter(code == 0)
exp_2 <- read_csv(file = 'data/exp_2_data.csv')
exp_3 <- read_csv(file = 'data/exp_3_data.csv')

#compute parameter summary statistics  
exp_1_long <- exp_1 %>%
    filter(code == 0) %>%
    #place parameter estimates in one column
    pivot_longer(cols = contains(c('theta', 'alpha', 'beta', 'gamma', 'epsilon')),
                 names_to = 'parameter', values_to = 'estimate') %>%
    filter(parameter == 'beta_fixed') %>%
    mutate(pop_value = midpoint)

exp_1_ordered <- order_param_spacing_levels(data = exp_1_long)

exp_1_ordered %>%
      #compute statistics for each parameter for each experimental variable
      group_by(parameter, .dots = locate_ivs(exp_1_ordered)) %>%
      summarize(
       lower_ci = compute_middle_95_estimate(param_data = estimate)[1],
       upper_ci = compute_middle_95_estimate(param_data = estimate)[2])

compute_parameter_summary(data = exp_1, exp_num = '1')

param_summary_exp_1 <- compute_parameter_summary(data = exp_1, exp_num = 1)
param_summary_exp_2 <- compute_parameter_summary(data = exp_2, exp_num = 2)
param_summary_exp_3 <- compute_parameter_summary(data = exp_3, exp_num = 3)

#necessary factor conversions 
param_summary_exp_1$number_measurements <- factor(param_summary_exp_1$number_measurements, levels = c(5, 7, 9,11))
param_summary_exp_1$midpoint <- factor(param_summary_exp_1$midpoint, levels = c(80, 180,280))

param_summary_exp_2$number_measurements <- factor(param_summary_exp_2$number_measurements, levels = c(5, 7, 9,11))
param_summary_exp_2$sample_size <- factor(param_summary_exp_2$sample_size, levels = c(30, 50, 100, 200, 500, 1000))

param_summary_exp_3$number_measurements <- factor(param_summary_exp_3$number_measurements, levels = c(5, 7, 9,11))
param_summary_exp_3$sample_size <- factor(param_summary_exp_3$sample_size, levels = c(30, 50, 100, 200, 500, 1000))

#write data sets 
#save parameter summary files as RData files so that metadata are correctly stored (e.g., factor levels, variable types)
saveRDS(object = param_summary_exp_1, file = 'data/uf_param_summary_exp_1.RData')
saveRDS(object = param_summary_exp_2, file = 'data/uf_param_summary_exp_2.RData')
saveRDS(object = param_summary_exp_3, file = 'data/uf_param_summary_exp_3.RData')
```

# Experiment 2 {#Exp2}

In Experiment 2, I investigated the measurement number and sample size combinations needed to obtain high model performance (i.e., unbiased and precise parameter estimation) under different spacing schedules. Before presenting the results of Experiment 2, I present my design and and analysis goals. For my design goals, I conducted a 4 (spacing schedule: equal, time-interval increasing, time-interval decreasing, middle-and-extreme) x 4(number of measurements: 5, 7, 9, 11) x 6(sample size: 30, 50, 100, 200, 500, 1000) study. For my analysis goals, I was interested in determining, for each spacing schedule, the measurement number and sample size combinations needed to obtain high model performance (i.e., unbiased and precise parameter estimation). For parsimony, I present model performance across all manipulated combinations of measurement number and sample size for each spacing schedule.

## Methods
### Overview of Data Generation

Data generation was computed the same way as in Experiment 1 (see [data generation](#data-generation)). Note that the code used to run the simulations and create the data set can be found in Appendix \ref{simulation-code} and the data file (`exp_2_data.csv`) can be found in the following GitHub repository: [https://github.com/sciarraseb/dissertation](https://github.com/sciarraseb/dissertation).  

### Modelling of Each Generated Data Set {#data-modelling-exp2}

Each generated data set was modelled using the structured latent growth curve model outlined in Experiment 1 (see [data modelling](#data-modelling) and explanation in Appendix \ref{structured-lgc}).

### Variables Used in Simulation Experiment 

#### Independent Variables

##### Spacing of Measurements

For the spacing of measurements, I used the same measurement days as in Experiment 1 for equal, time-interval increasing, time-interval decreasing, and middle-and-extreme spacing (see [spacing of measurements](#spacing-measurements) for more discussion).

##### Number of Measurements

For the number of measurements, I used the same values as in Experiment 1 of 5, 7, 9, and 11 measurements (see [number of measurements](#number-measurements) for more discussion). 

##### Sample Size {#sample-size}

Sample size values were adopted from @coulombe2016 with one difference.
Because my experiments investigated the effects of measurement timing
factors on the ability to model nonlinear patterns, which are inherently
more complex than linear patterns of change, a sample size value of *N*
= 1000 was added as the largest sample size. Therefore, the following
values were used for my sample size manipulation: 30, 50, 100, 200, 500,
and 1000.

#### Constants {#constants-exp2}

Given that each simulation experiment manipulated no more than three independent variables so that results could be readily interpreted [@halford2005], other variables had to be set to constant values. In Experiment 2, two important variables were set to constant values: nature of change and time structuredness. For nature of change, I set the value for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$) across all cells to 180. For time structuredness, data across all cells were generated to be time structured (i.e., all participants provide data according to one response pattern; that is, at each time point, participants provide their data at the exact same moment).


#### Dependent Variables

##### Convergence Success Rate

The proportion of iterations in a cell where models converged defined
the *convergence success rate*.\footnote{Specifically, convergence was obtained if the convergence code returned by OpenMx was 0.} Equation \@ref(eq:convergence) below shows the calculation used to compute the convergence success rate:

```{=tex}
\begin{align}
  \text{Convergence success rate} =  \frac{\text{Number of models that successfully converged in a cell}}{n},
  (\#eq:convergence) 
\end{align}
```
\noindent where *n* represents the total number of models run in a cell.

##### Model Performance 

Model performance was the combination of two metrics: bias and precision. More specifically, two questions were of importance in the estimation of a given logistic function parameter: 1) How well was the parameter estimated on average (bias) and 2) what was a range of values that could be expected for an estimate from the output of a single model (precision). In the two sections that follow, I will discuss each metric of model performance and the cutoffs used to determine whether estimation was unbiased and precise. 


###### Bias 

Bias was calculated to evaluate the accuracy with which each logistic
function parameter was estimated in each experimental cell. As shown below in Equation
\@ref(eq:bias-2), *bias* was obtained by summing the differences
between the population value set for a parameter and the value estimated for the parameter by each $i$ converged model and then dividing the sum by the number of $N$ converged models. 

```{=tex}
\begin{align}
  \text{Bias} = \frac{\sum_i^N\text{(Population value for parameter} - \text{Average estimated value}_i)}{N}
  (\#eq:bias-2) 
\end{align}
```

\noindent Bias was calculated for the fixed- and random-effect parameters of the baseline ($\uptheta_{fixed}$, $\uptheta_{random}$), maximal elevation ($\upalpha_{fixed}$, $\upalpha_{random}$), days-to-halfway elevation ($\upbeta_{fixed}$, $\upbeta_{random}$), and the triquarter-halfway delta parameters ($\upgamma_{fixed}$, $\upgamma_{random}$) and the error parameter ($\upepsilon$). 

###### Precision

In addition to computing bias, precision was calculated to evaluate the variability with which each parameter was estimated. Importantly, metrics used to evaluate precision in previous studies often assume estimates are normally distributed (e.g., mean-squared error and empirical standard error). Because some parameters in my simulations had skewed distributions, using a metric that assumed a normal distribution would likely yield inaccurate results. Correspondingly, I used a distribution-independent definition of precision. In my simulations, *precision* was defined as the range of values covered by the middle 95% of values estimated for a logistic function parameter. 


### Analysis of Data Modelling Output and Accompanying Visualizations

Analysis and visualization was conducted as outlined in Experiment 1 (see [analysis and visualization](#analysis-visualization})). 

## Results and Discussion

In the sections that follow, I organize the results by presenting them for each spacing schedule (equal, time-interval increasing, time-interval decreasing, middle-and-extreme). Importantly, only the results for the day-unit parameters will be presented (i.e., fixed- and random-effect days-to-halfway elevation and triquarter-halfway delta parameters [$\upbeta_{fixed}$, $\upbeta_{random}$, $\upgamma_{fixed}$, $\upgamma_{random}$, respectively]). The results for the likert-unit parameters (i.e., fixed- and random-effect baseline and maximal elevation parameters [$\uptheta_{fixed}$, $\uptheta_{random}$, $\upalpha_{fixed}$, $\upalpha_{random}$, respectively]) were largely trivial and so are presented in Appendix \ref{complete-versions}. 

### Framework for Interpreting Results

To conduct Experiment 2, the three variables of number of measurements (4 levels), spacing of measurements (4 levels), and sample size (9 levels) were manipulated, which yielded a total of 96 cells. Importantly, within each cell, bias and precision values were also computed for each of the nine parameters estimated by the structured latent growth curve models (for a review, see [modelling of each generated data set](#modelling-data-sets)). Thus, because the analysis of Experiment 2 computed values for many dependent variables, interpreting the results can become overwhelming. Therefore, I will provide a framework to help the reader efficiently navigate the results section. 

Because I will present the results of Experiment 2 by each level of measurement spacing, the framework I will describe in Figure \ref{fig:results-plot-primer-exp2} shows a template for the bias/precision plots that I will present for each spacing schedule. The results of each spacing schedule contain a bias/precision plot for each of the nine estimated parameters. Each bias/precision plot shows the bias and precision for the estimation of one parameter across all measurement number and sample size levels. Within each bias/precision plot, dots indicate the average estimated value (which indicates bias) and error bars represent the middle 95% range of estimated values (which indicates precision). Bias/precision plots with black borders show the results for day-unit parameters and plots with gray border show the results for Likert-unit parameters. Importantly, only the results for the day-unit parameters will be presented (i.e., fixed- and random-effect days-to-halfway elevation and triquarter-halfway delta parameters [$\upbeta_{fixed}$, $\upbeta_{random}$, $\upgamma_{fixed}$, $\upgamma_{random}$, respectively]). The results for the Likert-unit parameters (i.e., fixed- and random-effect baseline and maximal elevation parameters [$\uptheta_{fixed}$, $\uptheta_{random}$, $\upalpha_{fixed}$, $\upalpha_{random}$, respectively]) were largely trivial and so are presented in Appendix \ref{complete-versions}. Therefore, the results of each spacing schedule will only present the bias/precision plots for four parameters (i.e., the day-unit parameters). 

```{=tex}
\begin{apaFigure}
[portrait]
[samepage]
[-0.2cm]
{Set of Bias/Precision Plots Constructed for Each Spacing Schedule in Experiment 2}
{results-plot-primer-exp2}
{.77}
{Figures/logistic_results_plot_exp2}
{A bias/precision plot is constructed for each parameter of the logistic function (see Equation \ref{eq:logFunction-generation}). Bias/precision plots with black borders show the results for day-unit parameters and plots with gray border show the results for Likert-unit parameters. For each parameter, bias and precision are shown across each combination of measurement number and sample size.}
\end{apaFigure}
```


### Pre-Processing of Data and Model Convergence

After collecting the output from the simulations, non-converged models
(and their corresponding parameter estimates) were removed from
subsequent analyses. Table \ref{tab:conv-exp-2} in Appendix \ref{convergence-tables} provides the convergence
success rates for each cell in Experiment 2. Model convergence was almost always above 90% and convergence rates, with rates only going below 90% in two cells (or instances) with five measurements. 

### Equal Spacing {#concise-example}

For equal spacing, Table \ref{tab:summary-table-equal-spacing-exp2} provides a concise summary of the results for the day-unit parameters (see Figure \ref{fig:exp2_plot_equal} for the corresponding bias/precision plots). The sections that follow will present the results for each column of Table \ref{tab:summary-table-equal-spacing-exp2} and provide elaboration when necessary. 

Before presenting the results for equal spacing, I provide a brief description of the concise summary table created for each spacing schedule and shown for equal spacing below in Table \ref{tab:summary-table-equal-spacing-exp2}. Text in the 'Unbiased' and 'Precise' columns indicates the measurement number/sample size pairings that, respectively, resulted in unbiased and precise estimation. Emboldened text in the 'Unbiased' and 'Qualitative Description' columns indicates the measurement number/sample size pairing that, respectively, resulted in unbiased estimation and the greatest improvements in bias and precision across all day-unit parameters (note that acceptable precision was not obtained in the estimation of all day-unit parameters with equal spacing). The 'Error Bar Length' column indicates the error bar length that resulted from using the lower-bounding measurement number/sample size pairing listed in the 'Qualitative Description' column (i.e., the maximum error bar

```{r summary-table-equal-spacing-exp2, echo=F}

#beta_fixed 
errorbar_lengths_nm5_s30 <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Equal spacing', num_measurements = 5, sample_size = 30)

#gamma_fixed
errorbar_lengths_nm7_s200 <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Equal spacing', num_measurements = 7, sample_size = 200)
errorbar_lengths_nm9_s30 <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Equal spacing', num_measurements = 9, sample_size = 30)

#beta_rand
errorbar_lengths_nm7_s30 <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Equal spacing', num_measurements = 7, sample_size = 30)


#gamma_rand
errorbar_lengths_nm7_s100 <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Equal spacing', num_measurements = 7, sample_size = 100)

errorbar_lengths <- c(errorbar_lengths_nm5_s30$errorbar_length[1],
                      errorbar_lengths_nm9_s30$errorbar_length[2],
                      errorbar_lengths_nm7_s30$errorbar_length[3],
                      errorbar_lengths_nm9_s30$errorbar_length[4])
                      
summary_table <- data.frame('Parameter' = c('\\thead[lt]{$\\upbeta_{fixed}$ \\\\ (Figure \\ref{fig:exp2_plot_equal}A)}',
                                            '\\thead[lt]{$\\gamma_{fixed}$ \\\\ (Figure \\ref{fig:exp2_plot_equal}B)}', 
                                            '\\thead[lt]{$\\upbeta_{random}$ \\\\ (Figure \\ref{fig:exp2_plot_equal}C)}', 
                                            '\\thead[lt]{$\\upgamma_{random}$ \\\\ (Figure \\ref{fig:exp2_plot_equal}D)}'), 
                            
                            'Unbiased' = c('All cells', 
                                           'All cells', 
                                           'All cells', 
                                           '\\thead[lt]{\\textbf{NM $\\boldsymbol{\\ge}$ 7 with \\textit{N} = 1000} or \\\\ 
                                           \\textbf{NM $\\boldsymbol{\\ge}$ 9 with \\textit{N} $\\boldsymbol{\\ge}$ 200} 
                                           or \\\\  \\textbf{NM = 11 with \\textit{N} = 100}}'),
                            
                            'Precise' = c('All cells', 
                                            '\\thead[lt]{NM $\\ge$ 9 with $N \\ge 500$}', 
                                            'No cells',
                                            'No cells'), 
                            
                            'Qualitative Description' = c('Unbiased and precise estimation in all cells', 

                                                      #gamma_fixed
                                                      '\\thead[lt]{Largest improvements in precision \\\\ 
                                                      using \\textbf{NM = 7 with \\textit{N} $\\boldsymbol{\\ge}$ 200} or \\\\
                                                      \\textbf{NM = 9 with \\textit{N} $\\boldsymbol{\\le}$ 100}}', 
                                                     
                                                      #beta_rand
                                                      'Largest improvements in precision with NM = 7',
                                                     
                                                      #gamma_rand
                                                      '\\thead[lt]{Largest improvements in bias and \\\\
                                                      precision using NM = 7 with \\textit{N} $\\ge$ 100 \\\\
                                                      or NM = 9 with \\textit{N} $\\le$ 50}'),
                            'Error Bar Length' = errorbar_lengths, 
                            
                            check.names = F)

kbl(x = summary_table, format = 'latex',
       longtable = T, booktabs = T, centering = T, escape = F,
    linesep = rep(x = '\\cmidrule{1-5}', times = nrow(summary_table) - 2), 
    caption = 'Concise Summary of Results for Equal Spacing in Experiment 2',
     align = c('l', 'l', 'l', 'l', 'c')) %>%
      #header
  column_spec(column = 1, width = '3cm') %>%
  column_spec(column = 2, width = '5cm') %>%
  column_spec(column = 3, width = '5cm') %>%
  column_spec(column = 4, width = '6.5cm') %>%
  column_spec(column = 5, width = '3cm') %>%
  add_header_above(header = c(' ' = 3, 'Description' = 2)) %>%
  footnote(escape = F, threeparttable = T, general_title = '',
           general = "\\\\textit{Note. }Text in the `Unbiased' and `Precise' columns indicates the measurement number/sample size pairings that, respectively, resulted in unbiased and precise estimation. Emboldened text in the `Unbiased' and `Qualitative Description' columns indicates the measurement number/sample size pairings that, respectively, resulted in unbiased estimates and the greatest improvements in bias and precision across all day-unit parameters (acceptable precision was not obtained in the estimation of all day-unit parameters with equal spacing). `Error Bar Length' column indicates the maximum error bar length that resulted from using the measurement number/sample size recommendation listed in the `Qualitative Description' column. Parameter names and population values are as follows: $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter = 180; $\\\\upgamma_{fixed}$ = fixed-effect triquarter-halfway delta parameter = 20; $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter = 10; $\\\\upgamma_{random}$ = random-effect triquarter-halfway delta parameter = 4. NM = number of measurements.") %>% 
  kable_styling(position = 'left') %>%
  landscape(margin = '2.54cm')

```

\noindent length).

#### Bias {#bias-equal-exp2}

Before presenting the results for bias, I provide a description of the set of bias/precision plots shown in Figure \ref{fig:exp2_plot_equal} and in the results sections for the other spacing schedules in Experiment 2. Figure \ref{fig:exp2_plot_equal} shows the bias/precision plots for each day-unit parameter and Table \ref{tab:omega-exp2-equal} provides the partial $\upomega^2$ values for each independent variable of each day-unit parameter. In Figure \ref{fig:exp2_plot_equal}, blue horizontal lines indicate the population values for each parameter (with population values of $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, and $\upgamma_{random}$ = 4.00). Gray bands indicate the $\pm 10\%$ margin of error for each parameter and unfilled dots indicate cells with average parameter estimates outside of the margin. Error bars represent the middle 95% of estimated values, with light blue error bars indicating imprecise estimation. I considered dots that fell outside the gray bands as biased and error bar lengths with at least one whisker length exceeding the 10% cutoff (i.e., or longer than the portion of the gray band underlying the whisker) as imprecise. Panels A--B show the bias/precision plots for the fixed- and random-effect days-to-halfway elevation parameters ($\upbeta_{fixed}$ and $\upbeta_{random}$, respectively). Panels C--D show the bias/precision plots for the fixed- and random-effect triquarter-halfway delta parameters ($\upgamma_{fixed}$ and $\upgamma_{random}$, respectively). Note that random-effect parameter units are in standard deviation units.

```{r exp2-density-plot-equal, include=F, eval=F}
##generate figure showing density distributions if gamma_fizxd at N = 500 and N = 1000 with middle 95% area shaded. Emphasize
##that longer error bars in  N = 1000 are likely a statistical artifact of the random number generating procedure. 
exp_2 <- read_csv('data/exp_2.csv') %>% filter(code == 0) #load data 
exp_2 <- convert_raw_var_to_sd(raw_data = exp_2) #var to sd conversion 

parameter_names <- c(bquote(expr = bold(A:~gamma[fixed]~"(N=500, 5 measurements)")),
                     bquote(expr = bold(B:~beta[random]~"(N=500, 5 measurements)")),
                     bquote(expr = bold(C:~gamma[fixed]~"(N=1000, 5 measurements)")),
                     bquote(expr = bold(D:~beta[random]~"(N=1000, 5 measurements)")))
                     
#1) Extract estimates for four parameter gamma_fixed and beta_rand when N =500 or 1000, num_measurements == 5, spacing == equal. 
##Convert to long format, with parameter name going into unique column and estimate becoming new column 
param_data_equal_exp_2 <- exp_2 %>%
  filter(number_measurements == 5, measurement_spacing == 'equal', sample_size %in% c(500, 1000)) %>%
  select(locate_ivs(exp_2),'gamma_fixed', 'beta_rand') %>%
  pivot_longer(cols = c(gamma_fixed, beta_rand), values_to = 'estimate') %>%
  unite(col = 'parameter', sample_size:name) 

#2) Replace parameter values with tag labels. 
param_data_equal_exp_2$parameter <- factor(param_data_equal_exp_2$parameter, 
                               levels = c("500_gamma_fixed", "500_beta_rand",
                                          "1000_gamma_fixed", "1000_beta_rand"), 
                               labels = parameter_names)

base_density_plot <- ggplot(data = param_data_equal_exp_2, mapping = aes(x = estimate, group = parameter)) +
   geom_density(size = 3) 

##create density data for each parameter 
density_data <- ggplot_build(plot = base_density_plot)$data[[1]]

param_search_names <- c("A\\:", "B\\:", "C\\:", "D\\:")

param_error_bar_ranges <- lapply(X = param_search_names, compute_ind_param_error_bar_range, param_data = param_data_equal_exp_2)

#3) Create base density plot so that density data can be created
base_density_plot <- ggplot(data = param_data_equal_exp_2, mapping = aes(x = estimate, group = parameter)) +
   geom_density(size = 3) 

##create density data for each parameter 
density_data <- ggplot_build(plot = base_density_plot)$data[[1]]

plot_ready_data <- rbindlist(pmap(.l = list(error_bar_range = param_error_bar_ranges, 
               group = 1:length(param_error_bar_ranges), 
               param_name =  as.character(parameter_names)), .f = compute_density, density_data = density_data))
plot_ready_data$parameter <- factor(plot_ready_data$parameter)


density_plot_equal_exp2 <- base_density_plot +
    scale_x_continuous(limits = c(0, 30), breaks = seq(from = 0, to = 30, by = 5), 
                       name = 'Value of parameter estimate (days)') + 
  
  #shaded filling
      geom_area(data = plot_ready_data, mapping = aes(x = day_value, y = probability), 
                show.legend = 'bin',  fill="grey", alpha = 1, color = 'black', size = 3) + 
    #error bar
    geom_errorbarh(data = plot_ready_data, inherit.aes = F,
                   mapping = aes(xmin = lower_ci, xmax = upper_ci, 
                                 y = max_density_value, height = 0.05), size = 3) + 

    #vertical dashed lines for error bars
    ##lower limit 
    geom_segment(inherit.aes = F, data = plot_ready_data, x = plot_ready_data$lower_ci, xend = plot_ready_data$lower_ci,
                 y = 0, yend = plot_ready_data$max_density_value, linetype = 2, size = 2) +
    ##upper limit
    geom_segment(inherit.aes = F, data = plot_ready_data, x = plot_ready_data$upper_ci, xend = plot_ready_data$upper_ci,
                 y = 0, yend = plot_ready_data$max_density_value, linetype = 2, size = 2) +  
    
    #facet_wrap(facets = ~ parameter, nrow = 2, ncol = 2) + 
    
    facet_wrap_custom( ~ parameter, scales = "free", ncol = 2, nrow = 2 ,
                                          dir = 'h', labeller = label_parsed,
                                          scale_overrides = list(scale_override(1,
                                                                                scale_y_continuous(name =  'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, .60))),
                                                                 scale_override(2, scale_y_continuous(name =  'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, .60))),
                                                                 scale_override(3,scale_y_continuous(name =  'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, .60))),
                                                                 scale_override(4, scale_y_continuous(name = 'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.90, by = 0.10),
                                                                                                   limits = c(0, .90))))) + 
  
    #plot aesthetics
    theme_classic() +

    theme(
      #panel details
      strip.background = element_rect(fill = "white", color = "white"),
      #original text size = 60, 150 for pre-results figures
      strip.text.x = element_text(face = 'bold', hjust = 0, size = 60, margin = unit(c(t = 0, r = 0, b = 1, l = 0), "cm")),

      #axis details
      axis.text = element_text(size = 60, color = 'black'),
      axis.title = element_text(size = 70),
      axis.title.x.bottom = element_markdown(),
      axis.line = element_line(size = 2),
      axis.ticks.length.x = unit(x = 1, units = 'cm'),
      axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "cm")),
      axis.title.y = element_text(margin = unit(c(t = 0, r = 3, b = 0, l = 0), units = 'cm')),
      axis.ticks = element_line(size = 2, colour = 'black'),
      axis.ticks.length.y =  unit(x = 1, units = 'cm'),

      #panel details
      panel.spacing.y = unit(x = 4, units = 'cm'),
      panel.spacing.x = unit(x = 2, units = 'cm'))
  
  
  #create PDF of faceted plot
  set_panel_size(p = density_plot_equal_exp2, height = unit(x = 28, units = 'cm'),
                 width = unit(x = 40, units = 'cm'),
                 file =  'Figures/density_plot_fixed_equal_exp2.pdf')

```

```{r exp2-density-plot-equal-fixed, include=F, eval=F}
param_error_bar_ranges <- lapply(X = param_search_names, compute_90_ind_param_error_bar_range, param_data = param_data_equal_exp_2)

#3) Create base density plot so that density data can be created
base_density_plot <- ggplot(data = param_data_equal_exp_2, mapping = aes(x = estimate, group = parameter)) +
   geom_density(size = 3) 

##create density data for each parameter 
plot_ready_data <- rbindlist(pmap(.l = list(error_bar_range = param_error_bar_ranges, 
               group = 1:length(param_error_bar_ranges), 
               param_name =  as.character(parameter_names)), .f = compute_density, density_data = density_data))
plot_ready_data$parameter <- factor(plot_ready_data$parameter)


density_equal_fixed_exp2 <- base_density_plot +
    scale_x_continuous(limits = c(0, 30), breaks = seq(from = 0, to = 30, by = 5), 
                       name = 'Value of parameter estimate (days)') + 
  
  #shaded filling
      geom_area(data = plot_ready_data, mapping = aes(x = day_value, y = probability), 
                show.legend = 'bin',  fill="grey", alpha = 1, color = 'black', size = 3) + 
    #error bar
    geom_errorbarh(data = plot_ready_data, inherit.aes = F,
                   mapping = aes(xmin = lower_ci, xmax = upper_ci, 
                                 y = max_density_value, height = 0.05), size = 3) + 

    #vertical dashed lines for error bars
    ##lower limit 
    geom_segment(inherit.aes = F, data = plot_ready_data, x = plot_ready_data$lower_ci, xend = plot_ready_data$lower_ci,
                 y = 0, yend = plot_ready_data$max_density_value, linetype = 2, size = 2) +
    ##upper limit
    geom_segment(inherit.aes = F, data = plot_ready_data, x = plot_ready_data$upper_ci, xend = plot_ready_data$upper_ci,
                 y = 0, yend = plot_ready_data$max_density_value, linetype = 2, size = 2) +  
    
    #facet_wrap(facets = ~ parameter, nrow = 2, ncol = 2) + 
    
     facet_wrap_custom( ~ parameter, scales = "free", ncol = 2, nrow = 2 ,
                                          dir = 'h', labeller = label_parsed,
                                          scale_overrides = list(scale_override(1,
                                                                                scale_y_continuous(name =  'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, .60))),
                                                                 scale_override(2, scale_y_continuous(name =  'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, .60))),
                                                                 scale_override(3,scale_y_continuous(name =  'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, .60))),
                                                                 scale_override(4, scale_y_continuous(name = 'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.90, by = 0.10),
                                                                                                   limits = c(0, .90))))) + 
    #plot aesthetics
    theme_classic() +

    theme(
      #panel details
      strip.background = element_rect(fill = "white", color = "white"),
      #original text size = 60, 150 for pre-results figures
      strip.text.x = element_text(face = 'bold', hjust = 0, size = 55, margin = unit(c(t = 0, r = 6, b = 1, l = 0), "cm")),

      #axis details
      axis.text = element_text(size = 60, color = 'black'),
      axis.title = element_text(size = 70),
      axis.title.x.bottom = element_markdown(),
      axis.line = element_line(size = 2),
      axis.ticks.length.x = unit(x = 1, units = 'cm'),
      axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "cm")),
      axis.title.y = element_text(margin = unit(c(t = 0, r = 3, b = 0, l = 0), units = 'cm')),
      axis.ticks = element_line(size = 2, colour = 'black'),
      axis.ticks.length.y =  unit(x = 1, units = 'cm'),

      #panel details
      panel.spacing.y = unit(x = 4, units = 'cm'),
      panel.spacing.x = unit(x = 2, units = 'cm'))
  
  
  #create PDF of faceted plot
  set_panel_size(p = density_equal_fixed_exp2, height = unit(x = 28, units = 'cm'),
                 width = unit(x = 40, units = 'cm'),
                 file =  'Figures/density_plots_equal_fixed_exp2.pdf')

```

With respect to bias for equal spacing, estimates were biased (i.e., above the acceptable 10% cutoff) for each day-unit parameter in the following cells:

* fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$; Figure \ref{fig:exp2_plot_equal}A): no cells. 
* fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$; Figure \ref{fig:exp2_plot_equal}B): no cells.
* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$; Figure \ref{fig:exp2_plot_equal}C): no cells. 


```{r plots-equal-exp2, include=F, eval=F}
generate_day_likert_facet_plot(analytical_data = exp_2_analytical, 
                               target_col = 'measurement_spacing', target_value = 'Equal spacing',
                               x_axis_name = expression("Sample Size ("*italic(N)*")"), 
                               x_axis_var = 'sample_size', exp_num = 'exp2_', beta_lower = 155, beta_upper = 210, beta_ticks = 5)
                                
```

```{=tex}
\begin{apaFigure}
[portrait]
[samepage]
[-0.2cm]
{Bias/Precision Plots for Day-Unit Parameters With Equal Spacing in Experiment 2}
{exp2_plot_equal}
{0.165}
{Figures/exp2_plot_days_equal spacing}
{Panel A: Bias/precision plot for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$). Panel B: Bias/precision plot for the fixed-effect triquarter-halfway elevation parameter ($\upgamma_{fixed}$). Panel C: Bias/precision plot for the random-effect days-to-halfway elevation parameter ($\upbeta_{random}$). Panel D: Bias/precision plot for the random-effect triquarter-halfway elevation parameter ($\upgamma_{random}$). Blue horizontal lines in each panel represent the population value for each parameter. Population values for each day-unit parameter are as follows: $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00. Gray bands indicate the $\pm 10\%$ margin of error for each parameter and unfilled dots indicate cells with average parameter estimates outside of the margin or biased estimates. Error bars represent the middle 95\% of estimated values, with light blue error bars indicating imprecise estimation. I considered dots that fell outside the gray bands as biased and error bar lengths with at least one whisker length exceeding the 10\% cutoff (i.e., or longer than the portion of the gray band underlying the whisker) as imprecise. Note that random-effect parameter units are in standard deviation units. See Table \ref{tab:param-exp-2} for specific values estimated for each parameter and Table \ref{tab:omega-exp2-equal} for $\upomega^2$ effect size values.}
\end{apaFigure}
```

```{r omega-exp2-equal, echo=F}
print_bias_var_omega_table(exp_data = exp_2_raw, target_col = 'measurement_spacing', target_value = 'equal', 
ind_vars = c('number_measurements', 'sample_size'), 
ind_var_acronyms = c('NM', 'S', 'NM x S'), 
caption = 'Partial $\\upomega^2$ Values for Independent Variables With Equal Spacing in Experiment 2',
footnote = '\\\\textit{Note .}NM = number of measurements $\\\\in$ \\\\{5, 7, 9, 11\\\\}, S = sample size $\\\\in$ \\\\{30, 50, 100, 200, 500, 1000\\\\}, NM x S = interaction between number of measurements and sample size,
$\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter,
           $\\\\upgamma_{fixed}$ = fixed-effect triquarter-halfway delta parameter, 
           $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter, and 
           $\\\\upgamma_{random}$ = random-effect triquarter-halfway delta parameter.', 
parameter_labels = c('$\\upbeta_{fixed}$ (Figure \\ref{fig:exp2_plot_equal}A)',
                     '$\\upbeta_{random}$ (Figure \\ref{fig:exp2_plot_equal}B)',
                     '$\\upgamma_{fixed}$ (Figure \\ref{fig:exp2_plot_equal}C)',
                     '$\\upgamma_{random}$ (Figure \\ref{fig:exp2_plot_equal}D)'))
```


* random-effect triquarter-halfway elevation parameter ($\upgamma_{random}$; Figure \ref{fig:exp2_plot_equal}D): five measurements across all sample sizes, seven measurements with $N \le 500$, nine measurements with $N \le 100$, and 11 measurements with $N \le 50$. 

In summary, with equal spacing, estimation of all the day-unit parameters across all manipulated nature-of-change values was unbiased using nine measurements with $N \ge 200$ or 11 measurements with $N = 100$, which is indicated by the emboldened text in the 'Unbiased' column of Table \ref{tab:summary-table-equal-spacing-exp2}. 

#### Precision {#precision-equal-exp2}

With respect to precision for equal spacing, estimates were imprecise (i.e., error bar length with at least one whisker length exceeding 10% of a parameter's population value) in the following cells for each day-unit parameter: 

* fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$; Figure \ref{fig:exp2_plot_equal}A): all cells. 
* fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$; Figure \ref{fig:exp2_plot_equal}B): five and seven measurements across all sample sizes and nine and 11 measurements with $N \le 200$.
* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$; Figure \ref{fig:exp2_plot_equal}C): all cells. 
* random-effect triquarter-halfway delta parameter [$\upgamma_{random}$] in Figure \ref{fig:exp2_plot_equal}D): all cells. 

In summary, with equal spacing, precise estimation was obtained for the fixed-effect day-unit parameters using at least nine measurements with $N \ge 500$, but no manipulated measurement number/sample size pairing resulted in precise estimation of the random-effect day-unit parameters (see the 'Precise' column of Table \ref{tab:summary-table-equal-spacing-exp2}). 

```{r density-ranges, echo=F}
#fixed-effect days-to-halfway elevation parameter (5, 500)
beta_fixed_equal_5_500 <- exp_2_analytical$days %>% 
  filter(measurement_spacing == 'Equal spacing', number_measurements == 5, sample_size == 500, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

#fixed-effect days-to-halfway elevation parameter (5, 500)
beta_fixed_equal_5_1000 <- exp_2_analytical$days %>% 
  filter(measurement_spacing == 'Equal spacing', number_measurements == 5, sample_size == 1000, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))
```

#### Qualitative Description {#qualitative-equal-exp2}

For equal spacing in Figure \ref{fig:exp2_plot_equal}, although no manipulated measurement number resulted in precise estimation of all the day-unit parameters, the largest improvements in precision (and bias) resulted from using moderate measurement number/sample size pairings. With respect to bias under equal spacing, the largest improvements resulted with the following measurement number/sample size pairings for the fixed- and random-effect triquarter-halfway delta parameters ($\upgamma_{fixed}$ and $\upgamma_{random}$, respectively): 

* fixed-effect triquarter-halfway delta parameters  ($\upgamma_{fixed}$): seven measurements with $N = 30$. 
* random-effect triquarter-halfway delta parameters  ($\upgamma_{random}$): seven measurements with $N \ge 100$ or nine measurements with $N \le 50$. 

\noindent With respect to precision under equal spacing, the largest improvements in the estimation of all day-unit parameters (except the fixed-effect days-to-halfway elevation parameter [$\upbeta_{fixed}$]) resulted from using the following measurement number/sample size pairings:

* fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$): seven measurements with $N \ge 200$ or nine measurements with $N \le 100$, which resulted in a maximum error bar length of `r errorbar_lengths[2]` days. 
* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$): seven measurements across all manipulated sample sizes, which which resulted in a error bar length of `r errorbar_lengths[3]` days.
* random-effect triquarter-halfway delta parameter ($\upgamma_{random}$):  seven measurements with $N \ge 100$ or nine measurements with $N \le 50$, which resulted in a maximum error bar length of `r errorbar_lengths[4]` days.

For an applied researcher, one plausible question might be what measurement number/sample size pairing(s) results in the greatest improvements in bias and precision in the estimation of all day-unit parameters. In looking across the measurement number/sample size pairings in the above lists, it becomes apparent that the greatest improvements in bias and precision in the estimation of all day-unit parameters resulted from using seven measurements with $N \ge 200$ or nine measurements with $N \le 100$ (see the emboldened text in the 'Qualitative Description' column of Table \ref{tab:summary-table-equal-spacing-exp2}).

#### Summary of Results With Equal Spacing

In summarizing the results for equal spacing, estimation of all day-unit parameters was unbiased using nine measurements with $N \ge 200$ or 11 measurements with $N = 1000$ (see the emboldened text in in the 'Unbiased' column of Table \ref{tab:summary-table-equal-spacing-exp2}). Precise estimation was never obtained in the estimation of all day-unit parameters with any manipulated measurement number/sample size pairing (see [precision](#precision-time-inc-exp2)). Although it may be discouraging that no manipulated measurement number/sample size pairing under equal spacing resulted in precise estimation of all the day-unit parameters, the largest improvements in precision (and bias) across all day-unit parameters resulted with moderate measurement number/sample size pairings. With equal spacing, the largest improvements in bias and precision in the estimation of all day-unit parameters resulted from using seven measurements with $N \ge 200$ or nine measurements with $N \le 100$ (see the emboldened text in the 'Qualitative Description' column of Table \ref{tab:summary-table-equal-spacing-exp2}). 


### Time-Interval Increasing Spacing

For time-interval increasing spacing, Table \ref{tab:summary-table-time-inc-exp2} provides a concise summary of the results for the day-unit parameters (see Figure \ref{fig:exp2_plot_time_inc} for the corresponding bias/precision plots). The sections that follow will present the results for each column of Table \ref{tab:summary-table-time-inc-exp2} and provide elaboration when necessary (for a description of Table \ref{tab:summary-table-time-inc-exp2}, see [concise summary table](#concise-example)). 

#### Bias {#bias-time-inc-exp2}

With respect to bias for time-interval increasing spacing, estimates were biased (i.e., above the acceptable 10% cutoff) for each day-unit parameter in the following cells:

* fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$; Figure \ref{fig:exp2_plot_time_inc}A): no cells. 
* fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$; Figure \ref{fig:exp2_plot_time_inc}B): no cells.
* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$; Figure \ref{fig:exp2_plot_time_inc}C): NM = 5 with $N = 30$.  


```{r summary-table-time-inc-exp2, echo=F}
#beta_fixed 
errorbar_lengths_nm5_s30 <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Time-interval increasing', num_measurements = 5, sample_size = 30)
errorbar_lengths_nm7_s30 <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Time-interval increasing', num_measurements = 7, sample_size = 30)
errorbar_lengths_nm9_s30 <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Time-interval increasing', num_measurements = 9, sample_size = 30)


errorbar_lengths <- c(paste(errorbar_lengths_nm7_s30$errorbar_length[1]), 
                      paste(errorbar_lengths_nm9_s30$errorbar_length[2]), 
                      paste(errorbar_lengths_nm7_s30$errorbar_length[3]), 
                      paste(errorbar_lengths_nm9_s30$errorbar_length[4]))
                      

summary_table <- data.frame('Parameter' = c('\\thead[lt]{$\\upbeta_{fixed}$ \\\\ (Figure \\ref{fig:exp2_plot_time_inc}A)}',
                                            '\\thead[lt]{$\\gamma_{fixed}$ \\\\ (Figure \\ref{fig:exp2_plot_time_inc}B)}', 
                                            '\\thead[lt]{$\\upbeta_{random}$ \\\\ (Figure \\ref{fig:exp2_plot_time_inc}C)}', 
                                            '\\thead[lt]{$\\upgamma_{random}$ \\\\ (Figure \\ref{fig:exp2_plot_time_inc}D)}'), 
                            
                            'Unbiased' = c('All cells', 
                                           'All cells', 
                                           'All cells except', 
                                           '\\thead[lt]{\\textbf{NM $\\mathbf{\\ge}$ 9 with \\textit{N} $\\boldsymbol{\\ge}$ 200} or \\\\ \\textbf{NM = 11 with \\textit{N} = 1000}}'),
                            
                            'Precise' = c('All cells except NM = 5 with \\textit{N} $\\le$ 200',
                                                 
                                            '\\thead[lt]{NM $\\ge$ 7 with \\textit{N} = 1000 or \\\\ 
                                            NM $\\ge$ 9 with \\textit{N} = 1000}', 
                                            'No cells',
                                            'No cells'), 
                            
                            'Qualitative Description' = c('\\thead[lt]{Largest improvements in precision \\\\
                                                      using NM = 7 across all sample sizes }', 

                                                      '\\thead[lt]{Largest improvements in precision \\\\
                                                        using \\textbf{NM = 7 with} \\textbf{\\textit{N} $\\boldsymbol{\\ge}$ 200} or \\\\ NM = 9 with \\textit{N} $\\boldsymbol{\\le}$ 100}', 
                                                      
                                                      '\\thead[lt]{Largest improvements in precision \\\\
                                                      using NM = 7 across all sample sizes}',
                                                     
                                                      '\\thead[lt]{Largest improvements in bias and \\\\
                                                       precision using \\textbf{NM = 5 with} 
                                                      \\textbf{\\textit{N} $\\boldsymbol{\\ge}$ 500} or \\\\
                                                      \\textbf{NM = 9 with \\textit{N} $\\boldsymbol{\\le}$ 200}}'),
                            
                            'Error Bar Length' = errorbar_lengths,

                            check.names = F)

kbl(x = summary_table, format = 'latex',
       longtable = T, booktabs = T, centering = T, escape = F,
        linesep = rep(x = '\\cmidrule{1-5}', times = nrow(summary_table) - 2), 
    caption = 'Concise Summary of Results for Time-Interval Increasing Spacing in Experiment 2',
     align = c('l', 'l', 'l', 'l', 'c')) %>%
      #header
  column_spec(column = 1, width = '3cm') %>%
  column_spec(column = 2, width = '5cm') %>%
  column_spec(column = 3, width = '5cm') %>%
  column_spec(column = 4, width = '6.5cm') %>%
  column_spec(column = 5, width = '3cm') %>%
  add_header_above(header = c(' ' = 3, 'Description' = 2)) %>%
  footnote(escape = F, threeparttable = T, general_title = '',
           general = "\\\\textit{Note. }Text in the `Unbiased' and `Precise' columns indicates the measurement number/sample size pairings that, respectively, resulted in unbiased and precise estimation. Emboldened text in the `Unbiased' and `Qualitative Description' columns indicates the measurement number/sample size pairings that, respectively, resulted in unbiased estimates and the greatest improvements in bias and precision across all day-unit parameters (acceptable precision was not obtained in the estimation of all day-unit parameters with time-interval increasing spacing). `Error Bar Length' column indicates the maximum error bar length that resulted from using the measurement number/sample size recommendation listed in the `Qualitative Description' column. Parameter names and population values are as follows: $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter = 180; $\\\\upgamma_{fixed}$ = fixed-effect triquarter-halfway delta parameter = 20; $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter = 10; $\\\\upgamma_{random}$ = random-effect triquarter-halfway delta parameter = 4. NM = number of measurements.") %>% 
  kable_styling(position = 'left') %>%
  landscape(margin = '2.54cm')

```

```{r plots-time-inc-exp2, include=F, eval=F}
generate_day_likert_facet_plot(analytical_data = exp_2_analytical,
                               target_col = 'measurement_spacing', target_value = 'Time-interval increasing',
                               x_axis_name = expression("Sample Size ("*italic(N)*")"), 
                               x_axis_var = 'sample_size', exp_num = 'exp2_', beta_lower = 155, beta_upper = 210, beta_ticks = 5)
```

```{=tex}
\begin{apaFigure}
[portrait]
[samepage]
[-0.2cm]
{Bias/Precision Plots for Day-Unit Parameters With Time-Interval Increasing Spacing in Experiment 2}
{exp2_plot_time_inc}
{0.16}
{Figures/exp2_plot_days_time-interval increasing}
{Panel A: Bias/precision plot for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$). Panel B: Bias/precision plot for the fixed-effect triquarter-halfway elevation parameter ($\upgamma_{fixed}$). Panel C: Bias/precision plot for the random-effect days-to-halfway elevation parameter ($\upbeta_{random}$). Panel D: Bias/precision plot for the random-effect triquarter-halfway elevation parameter ($\upgamma_{random}$). Blue horizontal lines in each panel represent the population value for each parameter. Population values for each day-unit parameter are as follows: $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00. Gray bands indicate the $\pm 10\%$ margin of error for each parameter and unfilled dots indicate cells with average parameter estimates outside of the margin or biased estimates. Error bars represent the middle 95\% of estimated values, with light blue error bars indicating imprecise estimation. I considered dots that fell outside the gray bands as biased and error bar lengths with at least one whisker length exceeding the 10\% cutoff (i.e., or longer than the portion of the gray band underlying the whisker) as imprecise. Note that random-effect parameter units are in standard deviation units. See Table \ref{tab:param-exp-2} for specific values estimated for each parameter and Table \ref{tab:omega-exp2-time-inc} for $\upomega^2$ effect size values.}
\end{apaFigure}
```

```{r omega-exp2-time-inc, echo=F}
print_bias_var_omega_table(exp_data = exp_2_raw, target_col = 'measurement_spacing', target_value = 'time_inc', 
ind_vars = c('number_measurements', 'sample_size'), 
ind_var_acronyms = c('NM', 'S', 'NM x S'), 
caption = 'Partial $\\upomega^2$ Values for Independent Variables With Time-Interval Increasing Spacing in Experiment 2',
footnote = '\\\\textit{Note .}NM = number of measurements $\\\\in$ \\\\{5, 7, 9, 11\\\\}, S = sample size $\\\\in$ \\\\{30, 50, 100, 200, 500, 1000\\\\}, NM x S = interaction between number of measurements and sample size,
$\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter,
           $\\\\upgamma_{fixed}$ = fixed-effect triquarter-halfway delta parameter, 
           $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter, and 
           $\\\\upgamma_{random}$ = random-effect triquarter-halfway delta parameter. \\\\phantom{ indicate conditions where}', 
parameter_labels = c('$\\upbeta_{fixed}$ (Figure \\ref{fig:exp2_plot_time_inc}A)',
                     '$\\upbeta_{random}$ (Figure \\ref{fig:exp2_plot_time_inc}B)',
                     '$\\upgamma_{fixed}$ (Figure \\ref{fig:exp2_plot_time_inc}C)',
                     '$\\upgamma_{random}$ (Figure \\ref{fig:exp2_plot_time_inc}D)'))
```

* random-effect triquarter-halfway elevation parameter ($\upgamma_{random}$; Figure \ref{fig:exp2_plot_time_inc}D): five and seven measurements across all sample sizes, nine measurements with $N \le 100$, and 11 measurements with $N \le 50$.

In summary, with time-interval increasing spacing, estimation of all the day-unit parameters was unbiased using nine measurements with $N \ge 200$ or 11 measurements with $N = 100$, which is indicated by the emboldened text in the 'Unbiased' column of Table \ref{tab:summary-table-time-inc-exp2}. 


#### Precision {#precision-time-inc-exp2}

With respect to precision for time-interval increasing spacing, estimates were imprecise (i.e., error bar length with at least one whisker length exceeding 10% of a parameter's population value) in the following cells for each day-unit parameter: 

* fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$; Figure \ref{fig:exp2_plot_time_inc}A): five measurements with $N \le 100$. 
* fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$; Figure \ref{fig:exp2_plot_time_inc}B): five measurements across all sample sizes, seven measurements with $N \le 500$, nine and 11 measurements with $N \le 200$.
* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$; Figure \ref{fig:exp2_plot_time_inc}C): all cells. 
* random-effect triquarter-halfway delta parameter [$\upgamma_{random}$] in Figure \ref{fig:exp2_plot_time_inc}D): all cells. 

In summary, with time-interval increasing spacing, precise estimation for the fixed-effect day-unit parameters resulted from using at least nine measurements with $N \ge 500$, but no manipulated measurement number/sample size pairing resulted in precise estimation of the random-effect day-unit parameters (see the 'Precise' column of Table \ref{tab:summary-table-time-inc-exp2}).

#### Qualitative Description {#qualitative-time-inc-exp2}

For time-interval increasing spacing in Figure \ref{fig:exp2_plot_time_inc}, although no manipulated measurement number/sample size pairing resulted in precise estimation of all the day-unit parameters, the largest improvements in precision (and bias) resulted from using moderate measurement number/sample size pairings. With respect to bias under time-interval increasing spacing, the largest improvements resulted with the following measurement number/sample size pairings for random-effect triquarter-halfway delta parameter ($\upgamma_{random}$): 

* random-effect triquarter-halfway delta parameters  ($\upgamma_{random}$): five measurements with $N \ge 100$ or nine measurements with $N \le 50$. 

\noindent With respect to precision under time-interval increasing spacing, the largest improvements in the estimation of each day-unit parameter resulted from using the following measurement number/sample size pairings:

* days-to-halfway elevation parameter ($\upbeta_{fixed}$): seven measurements with $N \ge 30$, which resulted in a maximum error bar length of `r errorbar_lengths[2]` days. 
* fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$): seven measurements with $N \ge 200$ or nine measurements with $N \le 100$, which resulted in a maximum error bar length of `r errorbar_lengths[2]` days. 
* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$): seven measurements across all manipulated sample sizes, which  resulted in a maximum error bar length of `r errorbar_lengths[3]` days.
* random-effect triquarter-halfway delta parameter ($\upgamma_{random}$): five measurements with $N \ge 500$ or nine measurements with $N \le 200$, which resulted in a maximum error bar length of `r errorbar_lengths[4]` days.

For an applied researcher, one plausible question might be what measurement number/sample size pairing(s) results in the greatest improvements in bias and precision in the estimation of all day-unit parameters when using time-interval increasing spacing. In looking across the measurement number/sample size pairings in the above lists, it becomes apparent that the greatest improvements in bias and precision in the estimation of all day-unit parameters with time-interval increasing spacing resulted from using  five measurements with $N \ge 500$ or nine measurements with $N \le 200$ (see the emboldened text in the 'Qualitative Description' column of Table \ref{tab:summary-table-time-inc-exp2}). 

#### Summary of Results With Time-Interval Increasing Spacing

In summarizing the results for time-interval increasing spacing, estimation of all day-unit parameters was unbiased using nine measurements with $N \ge 200$ or 11 measurements with $N = 100$ (see [bias](#bias-time-inc-exp2)). Precise estimation was never obtained in the estimation of all day-unit parameters with any manipulated measurement number/sample size pairing (see [precision](#precision-time-inc-exp2)). Although it may be discouraging that no manipulated measurement number/sample size pairing under time-interval increasing spacing resulted in precise estimation of all the day-unit parameters, the largest improvements in precision (and bias) across all the day-unit parameters were obtained with moderate measurement number/sample size pairings. With time-interval increasing spacing, the largest improvements in bias and precision in the estimation of all day-unit parameters resulted from using five measurements with $N \ge 500$ or nine measurements with $N \le 200$ (see [qualitative description](#qualitative-time-inc-exp2)). 

### Time-Interval Decreasing Spacing

For time-interval decreasing spacing, Table \ref{tab:summary-table-time-dec-exp2} provides a concise summary of the results for the day-unit parameters (see Figure \ref{fig:exp2_plot_time_dec} for the corresponding bias/precision plots). The sections that follow will present the results for each column of Table \ref{tab:summary-table-time-dec-exp2} and provide elaboration when necessary (for a description of Table \ref{tab:summary-table-time-dec-exp2}, see [concise summary table](#concise-example)). 

#### Bias {#bias-time-dec-exp2}

With respect to bias for time-interval decreasing spacing, estimates were biased (i.e., above the acceptable 10% cutoff) for each day-unit parameter in the following cells:


```{r summary-table-time-dec-exp2, echo=F}
#beta_fixed 
errorbar_lengths_nm7_s30 <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Time-interval decreasing', num_measurements = 7, sample_size = 30)

errorbar_lengths_nm9_s30 <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Time-interval decreasing', num_measurements = 9, sample_size = 30)


errorbar_lengths <- c(paste(errorbar_lengths_nm7_s30$errorbar_length[1]), 
                      paste(errorbar_lengths_nm9_s30$errorbar_length[2]), 
                      paste(errorbar_lengths_nm7_s30$errorbar_length[3]), 
                      paste(errorbar_lengths_nm9_s30$errorbar_length[4]))
                      

summary_table <- data.frame('Parameter' = c('\\thead[lt]{$\\upbeta_{fixed}$ \\\\ (Figure \\ref{fig:exp2_plot_time_dec}A)}',
                                            '\\thead[lt]{$\\gamma_{fixed}$ \\\\ (Figure \\ref{fig:exp2_plot_time_dec}B)}', 
                                            '\\thead[lt]{$\\upbeta_{random}$ \\\\ (Figure \\ref{fig:exp2_plot_time_dec}C)}', 
                                            '\\thead[lt]{$\\upgamma_{random}$ \\\\ (Figure \\ref{fig:exp2_plot_time_dec}D)}'), 
                            
                            'Unbiased' = c('All cells', 
                                           'All cells', 
                                           'All cells except NM = 5 with \\textit{N} = 50', 
                                           '\\thead[lt]{\\textbf{NM = 11 with \\textit{N} $\\boldsymbol{\\ge}$ 100}}'),
                            
                            'Precise' = c('All cells except NM = 5 with \\textit{N} $\\le$ 500',
                                                 
                                            '\\thead[lt]{ NM = 7 with \\textit{N} = 1000 or \\\\ 
                                            NM $\\ge$ 9 with \\textit{N} $\\ge$ 500}', 
                                            'No cells',
                                            'No cells'), 
                            
                            'Qualitative Description' = c('\\thead[lt]{Largest improvements in precision \\\\
                                                      using NM = 7 across all sample sizes}', 

                                                      '\\thead[lt]{Largest improvements in precision \\\\
                                                        using \\textbf{NM = 7 with} \\textbf{\\textit{N} $\\boldsymbol{\\ge}$ 200} or \\\\ NM = 9 with \\textit{N} $\\boldsymbol{\\le}$ 100}', 
                                                      
                                                      '\\thead[lt]{Largest improvements in precision \\\\
                                                      using NM = 7 across all sample sizes}',
                                                     
                                                      '\\thead[lt]{Largest improvements in bias and \\\\
                                                       precision using \\textbf{NM = 5 with} 
                                                      \\textbf{\\textit{N} $\\boldsymbol{\\ge}$ 500} \\\\
                                                      or \\textbf{NM = 9 with \\textit{N} $\\boldsymbol{\\le}$ 200}}'),
                            
                            'Error Bar Length' = errorbar_lengths,

                            check.names = F)

kbl(x = summary_table, format = 'latex',
       longtable = T, booktabs = T, centering = T, escape = F,
        linesep = rep(x = '\\cmidrule{1-5}', times = nrow(summary_table) - 2), 
    caption = 'Concise Summary of Results for Time-Interval Decreasing Spacing in Experiment 2',
     align = c('l', 'l', 'l', 'l', 'c')) %>%
      #header
  column_spec(column = 1, width = '3cm') %>%
  column_spec(column = 2, width = '5cm') %>%
  column_spec(column = 3, width = '5cm') %>%
  column_spec(column = 4, width = '6.5cm') %>%
  column_spec(column = 5, width = '3cm') %>%
  add_header_above(header = c(' ' = 3, 'Description' = 2)) %>%
  footnote(escape = F, threeparttable = T, general_title = '',
           general = "\\\\textit{Note. }Text in the `Unbiased' and `Precise' columns indicates the measurement number/sample size pairings that, respectively, resulted in unbiased and precise estimation. Emboldened text in the `Unbiased' and `Qualitative Description' columns indicates the measurement number/sample size pairings that, respectively, resulted in unbiased estimates and the greatest improvements in bias and precision across all day-unit parameters (acceptable precision was not obtained in the estimation of all day-unit parameters with time-interval decreasing spacing). `Error Bar Length' column indicates the maximum error bar length that resulted from using the measurement number/sample size recommendation listed in the `Qualitative Description' column. Parameter names and population values are as follows: $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter = 180; $\\\\upgamma_{fixed}$ = fixed-effect triquarter-halfway delta parameter = 20; $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter = 10; $\\\\upgamma_{random}$ = random-effect triquarter-halfway delta parameter = 4. NM = number of measurements.") %>% 
  kable_styling(position = 'left') %>%
  landscape(margin = '2.54cm')

```


```{r plots-time-dec-exp2, include=F, eval=F}
generate_day_likert_facet_plot(analytical_data = exp_2_analytical,
                               target_col = 'measurement_spacing', target_value = 'Time-interval decreasing',
                               x_axis_name = expression("Sample Size ("*italic(N)*")"), 
                               x_axis_var = 'sample_size', exp_num = 'exp2_', beta_lower = 155, beta_upper = 210, beta_ticks = 5)
                                
```

```{=tex}
\begin{apaFigure}
[portrait]
[samepage]
[-0.2cm]
{Bias/Precision Plots for Day-Unit Parameters With Time-Interval Decreasing Spacing in Experiment 2}
{exp2_plot_time_dec}
{0.16}
{Figures/exp2_plot_days_time-interval decreasing}
{Panel A: Bias/precision plot for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$). Panel B: Bias/precision plot for the fixed-effect triquarter-halfway elevation parameter ($\upgamma_{fixed}$). Panel C: Bias/precision plot for the random-effect days-to-halfway elevation parameter ($\upbeta_{random}$). Panel D: Bias/precision plot for the random-effect triquarter-halfway elevation parameter ($\upgamma_{random}$). Blue horizontal lines in each panel represent the population value for each parameter. Population values for each day-unit parameter are as follows: $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00. Gray bands indicate the $\pm 10\%$ margin of error for each parameter and unfilled dots indicate cells with average parameter estimates outside of the margin or biased estimates. Error bars represent the middle 95\% of estimated values, with light blue error bars indicating imprecise estimation. I considered dots that fell outside the gray bands as biased and error bar lengths with at least one whisker length exceeding the 10\% cutoff (i.e., or longer than the portion of the gray band underlying the whisker) as imprecise. Note that random-effect parameter units are in standard deviation units. See Table \ref{tab:param-exp-2} for specific values estimated for each parameter and Table \ref{tab:omega-exp2-time-dec} for $\upomega^2$ effect size values.}
\end{apaFigure}
```

```{r omega-exp2-time-dec, echo=F}
print_bias_var_omega_table(exp_data = exp_2_raw, target_col = 'measurement_spacing', target_value = 'time_dec', 
ind_vars = c('number_measurements', 'sample_size'), 
ind_var_acronyms = c('NM', 'S', 'NM x S'), 
caption = 'Partial $\\upomega^2$ Values for Independent Variables With Time-Interval Decreasing Spacing in Experiment 2',
footnote = '\\\\textit{Note .}NM = number of measurements $\\\\in$ \\\\{5, 7, 9, 11\\\\}, S = sample size $\\\\in$ \\\\{30, 50, 100, 200, 500, 1000\\\\}, NM x S = interaction between number of measurements and sample size, $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter,
           $\\\\upgamma_{fixed}$ = fixed-effect triquarter-halfway delta parameter, 
           $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter, and 
           $\\\\upgamma_{random}$ = random-effect triquarter-halfway delta parameter. \\\\phantom{ indicate conditions where}', 
parameter_labels = c('$\\upbeta_{fixed}$ (Figure \\ref{fig:exp2_plot_time_dec}A)',
                     '$\\upbeta_{random}$ (Figure \\ref{fig:exp2_plot_time_dec}B)',
                     '$\\upgamma_{fixed}$ (Figure \\ref{fig:exp2_plot_time_dec}C)',
                     '$\\upgamma_{random}$ (Figure \\ref{fig:exp2_plot_time_dec}D)'))
```

* fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$; Figure \ref{fig:exp2_plot_time_dec}A): no cells.
* fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$; Figure \ref{fig:exp2_plot_time_dec}B): no cells.
* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$; Figure \ref{fig:exp2_plot_time_dec}C): NM = 5 with $N = 30$.
* random-effect triquarter-halfway elevation parameter ($\upgamma_{random}$; Figure \ref{fig:exp2_plot_time_dec}D): five, seven, and nine measurements across all sample sizes an 11 measurements with $N \le 50$, and 11 measurements with $N \le 50$.

In summary, with time-interval decreasing spacing, estimation of all the day-unit parameters was unbiased using 11 measurements with $N \ge 100$, which is indicated by the emboldened text in the 'Unbiased' column of Table \ref{tab:summary-table-time-dec-exp2}. 


#### Precision {#precision-time-dec-exp2}

With respect to precision for time-interval decreasing spacing, estimates were imprecise (i.e., error bar length with at least one whisker length exceeding 10% of a parameter's population value) in the following cells for each day-unit parameter: 

* fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$; Figure \ref{fig:exp2_plot_time_dec}A): five measurements with $N \le 500$. 
* fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$; Figure \ref{fig:exp2_plot_time_dec}B): five measurements across all sample sizes, seven measurements with $N \le 500$, and nine and 11 measurements with $N \le 200$.
* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$; Figure \ref{fig:exp2_plot_time_dec}C): all cells. 
* random-effect triquarter-halfway delta parameter [$\upgamma_{random}$] in Figure \ref{fig:exp2_plot_time_dec}D): all cells. 

In summary, with time-interval decreasing spacing, precise estimation for the fixed-effect day-unit parameters resulted from using at least seven measurements with $N = 1000$ or nine measurements $N \le 500$. For the random-effect day-unit parameters, no manipulated measurement number/sample size pairing resulted in precise estimation (see the 'Precise' column of Table \ref{tab:summary-table-time-dec-exp2}).


#### Qualitative Description {#qualitative-time-dec-exp2}

For time-interval decreasing spacing in Figure \ref{fig:exp2_plot_time_dec}, although no manipulated measurement number resulted in precise estimation of all the day-unit parameters, the largest improvements in precision (and bias) resulted from using moderate measurement number/sample size pairings. With respect to bias under time-interval decreasing spacing, the largest improvements resulted with the following measurement number/sample size pairings for the random-effect triquarter-halfway delta parameter ($\upgamma_{random}$): 

* random-effect triquarter-halfway delta parameters ($\upgamma_{random}$): five measurements with $N \ge 100$ or nine measurements with $N \le 50$. 

\noindent With respect to precision under time-interval decreasing spacing, the largest improvements in the estimation of all day-unit parameters (except the fixed-effect days-to-halfway elevation parameter [$\upbeta_{fixed}$]) resulted from using the following measurement number/sample size pairings:

* days-to-halfway elevation parameter ($\upbeta_{fixed}$): seven measurements with $N \ge 30$, which resulted in a maximum error bar length of `r errorbar_lengths[2]` days. 
* fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$): seven measurements with $N \ge 200$ or nine measurements with $N \le 100$, which resulted in a maximum error bar length of `r errorbar_lengths[2]` days. 
* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$): seven measurements across all manipulated sample sizes, which which resulted in a error bar length of `r errorbar_lengths[3]` days.
* random-effect triquarter-halfway delta parameter ($\upgamma_{random}$): five measurements with $N \ge 500$ or nine measurements with $N \le 200$, which resulted in a maximum error bar length of `r errorbar_lengths[4]` days.

For an applied researcher, one plausible question might be what measurement number/sample size pairing(s) results in the greatest improvements in bias and precision in the estimation of all day-unit parameters with time-interval decreasing spacing. In looking across the measurement number/sample size pairings in the above lists, it becomes apparent that greatest improvements in bias and precision in the estimation of all day-unit parameters with time-interval decreasing spacing resulted with five measurements with $N \ge 500$, seven measurements with $N \ge 200$, or nine measurements with $N \le 200$ (see the emboldened text in the 'Qualitative Description' column of Table \ref{tab:summary-table-time-dec-exp2}). 

#### Summary of Results Time-Interval Decreasing Spacing

In summarizing the results for time-interval decreasing spacing, estimation of all day-unit parameters was unbiased using 11 measurements with $N \ge 10$ (see [bias](#bias-time-dec-exp2)). Precise estimation was never obtained in the estimation of all day-unit parameters with any manipulated measurement number/sample size pairing (see [precision](#precision-time-inc-exp2)). Although it may be discouraging that no manipulated measurement number/sample size pairing under time-interval decreasing spacing resulted in precise estimation of all day-unit parameters, the largest improvements in precision (and bias) across all day-unit parameters were obtained with moderate measurement number/sample size pairings. With time-interval decreasing spacing, the largest improvements in bias and precision in the estimation of all day-unit parameters resulted from using five measurements with $N \ge 500$ or nine measurements with $N \le 200$ (see [qualitative description](#qualitative-time-inc-exp2)). 

### Middle-and-Extreme Spacing

For middle-and-extreme spacing, Table \ref{tab:summary-table-mid-ext-exp2} provides a concise summary of the results for the day-unit parameters (see Figure \ref{fig:exp2_plot_mid_ext} for the corresponding bias/precision plots). The sections that follow will present the results for each column of Table \ref{tab:summary-table-mid-ext-exp2} and provide elaboration when necessary (for a description of Table \ref{tab:summary-table-mid-ext-exp2}, see [concise summary table](#concise-example)). 


```{r summary-table-mid-ext-exp2, echo=F}

errorbar_lengths_nm5_s30 <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Middle-and-extreme spacing', num_measurements = 5, sample_size = 30)

errorbar_lengths <- c(paste(errorbar_lengths_nm5_s30$errorbar_length[1]), 
                      paste(errorbar_lengths_nm5_s30$errorbar_length[2]), 
                      paste(errorbar_lengths_nm5_s30$errorbar_length[3]), 
                      paste(errorbar_lengths_nm5_s30$errorbar_length[4]))
                      
summary_table <- data.frame('Parameter' = c('\\thead[lt]{$\\upbeta_{fixed}$ \\\\ (Figure \\ref{fig:exp2_plot_mid_ext}A)}',
                                            '\\thead[lt]{$\\gamma_{fixed}$ \\\\ (Figure \\ref{fig:exp2_plot_mid_ext}B)}', 
                                            '\\thead[lt]{$\\upbeta_{random}$ \\\\ (Figure \\ref{fig:exp2_plot_mid_ext}C)}', 
                                            '\\thead[lt]{$\\upgamma_{random}$ \\\\ (Figure \\ref{fig:exp2_plot_mid_ext}D)}'), 
                            
                            'Unbiased' = c('All cells', 
                                           'All cells', 
                                           'All cells',
                                           
                                          '\\thead[lt]{\\textbf{NM $\\boldsymbol{\\in}$ \\{5, 9\\} with
                                           \\textit{N} $\\boldsymbol{\\ge}$ 100} or \\\\
                                           \\textbf{NM  $\\boldsymbol{\\in}$ \\{7, 11\\} with \\textit{N} $\\boldsymbol{\\le}$ 50}}'),
                            
                            'Precise' = c('All cells', 
                                          'All number of measurements with \\textit{N} $\\ge$ 500', 
                                           'No cells',
                                          'No cells'), 
                            
                            'Qualitative Description' = c('Largest improvements in precision using
                                                      using \\textbf{NM = 5}', 

                                                      'Largest improvements in precision using
                                                      \\textbf{NM = 5}', 
                                                      
                                                      'Largest improvements in precision using
                                                      \\textbf{NM = 5}',
                                                     
                                                      'Largest improvements in precision using
                                                      \\textbf{NM = 5}'),
                            'Error Bar Length' = errorbar_lengths,

                            check.names = F)

kbl(x = summary_table, format = 'latex',
       longtable = T, booktabs = T, centering = T, escape = F,
    caption = 'Concise Summary of Results for Middle-and-Extreme Spacing in Experiment 2',
        linesep = rep(x = '\\cmidrule{1-5}', times = nrow(summary_table) - 2), 
   align = c('l', 'l', 'l', 'l', 'c')) %>%
      #header
  column_spec(column = 1, width = '3cm') %>%
  column_spec(column = 2, width = '5cm') %>%
  column_spec(column = 3, width = '5cm') %>%
  column_spec(column = 4, width = '6.5cm') %>%
  column_spec(column = 5, width = '3cm') %>%
  add_header_above(header = c(' ' = 3, 'Description' = 2)) %>%
  footnote(escape = F, threeparttable = T, general_title = '',
           general = "\\\\textit{Note. }Text in the `Unbiased' and `Precise' columns indicates the measurement number/sample size pairings that, respectively, resulted in unbiased and precise estimation. Emboldened text in the `Unbiased' and `Qualitative Description' columns indicates the measurement number/sample size pairings that, respectively, resulted in unbiased estimates and the greatest improvements in bias and precision across all day-unit parameters (acceptable precision was not obtained in the estimation of all day-unit parameters with middle-and-extreme spacing). `Error Bar Length' column indicates the maximum error bar length that resulted from using the measurement number/sample size recommendation listed in the `Qualitative Description' column. Parameter names and population values are as follows: $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter = 180; $\\\\upgamma_{fixed}$ = fixed-effect triquarter-halfway delta parameter = 20; $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter = 10; $\\\\upgamma_{random}$ = random-effect triquarter-halfway delta parameter = 4. NM = number of measurements.") %>% 
  kable_styling(position = 'left') %>%
  landscape(margin = '2.54cm')


```



#### Bias {#bias-mid-ext-exp2}

With respect to bias for middle-and-extreme spacing, estimates were biased (i.e., above the acceptable 10% cutoff) for each day-unit parameter in the following cells:

* fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$; Figure \ref{fig:exp2_plot_time_dec}A): no cells. 
* fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$; Figure \ref{fig:exp2_plot_time_dec}B): no cells.
* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$; Figure \ref{fig:exp2_plot_time_dec}C): no cells.
* random-effect triquarter-halfway elevation parameter ($\upgamma_{random}$; Figure \ref{fig:exp2_plot_time_dec}D): five and nine measurements with $N \le 100$ and seven an 11 with $N \le 50$.

In summary, with middle-and-extreme spacing, estimation of all the day-unit parameters was unbiased using five and nine measurements with $N \le 100$ and seven an 11 with $N \le 50$, which is indicated by the emboldened text in the 'Unbiased' column of Table \ref{tab:summary-table-mid-ext-exp2}. 

#### Precision {#precision-mid-ext-exp2}

With respect to precision for middle-and-extreme spacing, estimates were imprecise (i.e., error bar length with at least one whisker length exceeding 10% of a parameter's population value) in the following cells for each day-unit parameter: 

* fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$; Figure \ref{fig:exp2_plot_time_dec}A): no cells. 
* fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$; Figure \ref{fig:exp2_plot_time_dec}B): all measurements numbers with $N \ge 200$. 
* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$; Figure \ref{fig:exp2_plot_time_dec}C): all cells. 
* random-effect triquarter-halfway delta parameter ($\upgamma_{random}$; Figure \ref{fig:exp2_plot_time_dec}D): all cells. 

In summary, with middle-and-extreme spacing, precise estimation for the fixed-effect day-unit parameters resulted from using at least five measurements with $N \ge 500$.

```{r plots-mid-ext-exp2, include=F, eval=F}
generate_day_likert_facet_plot(analytical_data = exp_2_analytical,
                               target_col = 'measurement_spacing', target_value = 'Middle-and-extreme spacing',
                               x_axis_name = expression("Sample Size ("*italic(N)*")"), 
                               x_axis_var = 'sample_size', exp_num = 'exp2_', beta_lower = 155, beta_upper = 210, beta_ticks = 5)
```

```{=tex}
\begin{apaFigure}
[portrait]
[samepage]
[-0.2cm]
{Bias/Precision Plots for Day-Unit Parameters With Middle-and-Extreme Spacing in Experiment 2}
{exp2_plot_mid_ext}
{0.16}
{Figures/exp2_plot_days_middle-and-extreme spacing}
{Panel A: Bias/precision plot for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$). Panel B: Bias/precision plot for the fixed-effect triquarter-halfway elevation parameter ($\upgamma_{fixed}$). Panel C: Bias/precision plot for the random-effect days-to-halfway elevation parameter ($\upbeta_{random}$). Panel D: Bias/precision plot for the random-effect triquarter-halfway elevation parameter ($\upgamma_{random}$). Blue horizontal lines in each panel represent the population value for each parameter. Population values for each day-unit parameter are as follows: $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00. Gray bands indicate the $\pm 10\%$ margin of error for each parameter and unfilled dots indicate cells with average parameter estimates outside of the margin or biased estimates. Error bars represent the middle 95\% of estimated values, with light blue error bars indicating imprecise estimation. I considered dots that fell outside the gray bands as biased and error bar lengths with at least one whisker length exceeding the 10\% cutoff (i.e., or longer than the portion of the gray band underlying the whisker) as imprecise. Note that random-effect parameter units are in standard deviation units. See Table \ref{tab:param-exp-2} for specific values estimated for each parameter and Table \ref{tab:omega-exp2-mid-ext} for $\upomega^2$ effect size values.}
\end{apaFigure}
```

```{r omega-exp2-mid-ext, echo=F}
print_bias_var_omega_table(exp_data = exp_2_raw, target_col = 'measurement_spacing', target_value = 'time_dec', 
ind_vars = c('number_measurements', 'sample_size'), 
ind_var_acronyms = c('NM', 'S', 'NM x S'), 
caption = 'Partial $\\upomega^2$ Values for Independent Variables With Middle-and-Extreme Spacing in Experiment 2',
footnote = '\\\\textit{Note .}NM = number of measurements $\\\\in$ \\\\{5, 7, 9, 11\\\\}, S = sample size $\\\\in$ \\\\{30, 50, 100, 200, 500, 1000\\\\}, NM x S = interaction between number of measurements and sample size, $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter,
           $\\\\upgamma_{fixed}$ = fixed-effect triquarter-halfway delta parameter, 
           $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter, and 
           $\\\\upgamma_{random}$ = random-effect triquarter-halfway delta parameter. \\\\phantom{ indicate conditions where}', 
parameter_labels = c('$\\upbeta_{fixed}$ (Figure \\ref{fig:exp2_plot_mid_ext}A)',
                     '$\\upbeta_{random}$ (Figure \\ref{fig:exp2_plot_mid_ext}B)',
                     '$\\upgamma_{fixed}$ (Figure \\ref{fig:exp2_plot_mid_ext}C)',
                     '$\\upgamma_{random}$ (Figure \\ref{fig:exp2_plot_mid_ext}D)'))
```

\noindent For the random-effect day-unit parameters, no manipulated measurement number/sample size pairing resulted in precise estimation (see the 'Precise' column of Table \ref{tab:summary-table-mid-ext-exp2}).


#### Qualitative Description {#qualitative-mid-ext-exp2}

For middle-and-extreme spacing in Figure \ref{fig:exp2_plot_mid_ext}, although no manipulated measurement number resulted in precise estimation of all the day-unit parameters, the largest improvements in precision (and bias) resulted from using moderate measurement number/sample size pairings. With respect to bias under middle-and-extreme spacing, it was negligible under all manipulated measurement number/sample size pairings, and so there was little value in listing the pairings that resulted in the greatest improvements. With respect to precision under middle-and-extreme spacing, the largest improvements in the estimation of all day-unit parameters (except the fixed-effect days-to-halfway elevation parameter [$\upbeta_{fixed}$]) resulted from using the following measurement number/sample size pairings:

* fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$): five measurements across all sample sizes, which resulted in a maximum error bar length of `r errorbar_lengths[2]` days. 
* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$): five measurements across all sample sizes, which resulted in a maximum error bar length of `r errorbar_lengths[3]` days. 
* random-effect triquarter-halfway delta parameter ($\upgamma_{random}$): five measurements across all sample sizes, which resulted in a maximum error bar length of `r errorbar_lengths[4]` days. 

For an applied researcher, one plausible question might be what measurement number/sample size pairing(s) results in the greatest improvements in bias and precision in the estimation of all day-unit parameters with middle-and-extreme spacing. In looking across the measurement number/sample size pairings in the above lists, it becomes apparent that greatest improvements in bias and precision in the estimation of all day-unit parameters with middle-and-extreme spacing resulted from using five measurments with any sample size (see the emboldened text in the 'Qualitative Description' column of Table \ref{tab:summary-table-mid-ext-exp2}). 

#### Summary of Results with Middle-and-Extreme Spacing

In summarizing the results for middle-and-extreme spacing, estimation of all day-unit parameters was unbiased using five or nine measurements with $N \le 100$ and seven or 11 with $N \le 50$ (see [bias](#bias-mid-ext-exp2)). Precise estimation was never obtained in the estimation of all day-unit parameters with any manipulated measurement number/sample size pairing (see [precision](#precision-mid-ext-exp2)). Although it may be discouraging that no manipulated measurement number/sample size pairing under time-interval decreasing spacing resulted in precise estimation of all the day-unit parameters, the largest improvements in precision (and bias) across all day-unit parameters resulted with moderate measurement number/sample size pairings. With middle-and-extreme spacing, the largest improvements in bias and precision in the estimation of all day-unit parameters resulted from using five measurements with any sample size (see [qualitative description](#qualitative-mid-ext-exp2)). 



## What Measurement Number/Sample Size Pairings Should be Used With Each Spacing Schedule? 

In Experiment 2, I was interested in determining the measurement number/sample size pairings that resulted in high model performance (unbiased and precise parameter estimation) for each spacing schedule. Table \ref{tab:summary-table-exp2} summarizes the results for each spacing schedule in Experiment 2. Text within the 'Unbiased' and 'Precise' columns indicates the measurement number/sample size pairing needed to, respectively, obtain unbiased an precise estimation of all the day-unit parameters. The 'Error Bar Length' column indicates maximum error bar length that results in the estimation of each day-unit parameter from using the measurement number/sample size pairings listed in the 'Qualitative Description' column. Although no measurement number/sample size pairing results in high model performance for any spacing schedule, the greatest improvements in model performance result from using the following measurement number/sample size pairings for each spacing schedule (see Table \ref{tab:summary-table-exp2}): 

* equal: seven measurements with *N* $\ge$ 200 or nine measurements with *N* $\le$ 100.

```{r summary-table-exp2, echo=F}

#error bar lengths for each spacing schedule
errorbar_lengths_equal <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Equal spacing', num_measurements = 9, sample_size = 30)$errorbar_length

errorbar_lengths_time_inc_nm9_s30 <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Time-interval increasing', num_measurements = 9, sample_size = 30)$errorbar_length

errorbar_lengths_time_dec_nm9_s30 <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Time-interval decreasing', num_measurements = 9, sample_size = 30)$errorbar_length

errorbar_lengths_mid_ext <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Middle-and-extreme spacing', num_measurements = 5, sample_size = 30)$errorbar_length

#combine vectors into a list 
errorbar_lengths_list <- list('equal' = errorbar_lengths_equal, 
                              'time_inc' = errorbar_lengths_time_inc_nm9_s30, 
                              'time_dec' = errorbar_lengths_time_dec_nm9_s30, 
                              'mid_ext' = errorbar_lengths_mid_ext)

beta_fixed_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[1])})))
gamma_fixed_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[2])})))
beta_rand_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[3])})))
gamma_rand_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[4])})))


summary_table <- data.frame('Spacing Schedule' = c('\\thead[lt]{Equal \\\\(see Figure \\ref{fig:exp2_plot_equal} and 
                                                   Table \\ref{tab:summary-table-equal-spacing-exp2})}',
                                                   
                                                   '\\thead[lt]{Time-interval increasing  \\\\ 
                                                   (see Figure \\ref{fig:exp2_plot_time_inc} and 
                                                   Table \\ref{tab:summary-table-time-inc-exp2})}',
                                                   
                                                   '\\thead[lt]{Time-interval decreasing \\\\ 
                                                   (see Figure \\ref{fig:exp2_plot_time_dec} and 
                                                   Table \\ref{tab:summary-table-time-dec-exp2})}', 
                                                   
                                                   '\\thead[lt]{Middle and extreme \\\\ 
                                                   (see Figure \\ref{fig:exp2_plot_mid_ext} and 
                                                   Table \\ref{tab:summary-table-mid-ext-exp2})}'), 
                            
                            'Unbiased' = c('\\thead[lt]{NM $\\ge$ 7 with \\textit{N} = 1000 or \\\\
                                           NM $\\ge$ 9 with \\textit{N} $\\ge$ 100}', 
                                           
                                           '\\thead[lt]{NM $\\ge$ 9 with \\textit{N} $\\ge$ 200 or \\\\
                                           NM = 11 with \\textit{N} = 1000}', 
                                           
                                           '\\thead[lt]{NM = 11 with \\textit{N} $\\ge$ 1000}', 
                                           
                                           '\\thead[lt]{NM $\\boldsymbol{\\ge}$ 5 with
                                           \\textit{N} $\\boldsymbol{\\ge}$ 200 or \\\\
                                           NM  $\\boldsymbol{\\in}$ \\{5, 7\\} with \\textit{N} = 100}'), 
                            
                            'Precise' = c('No cells', 
                                            'No cells', 
                                            'No cells',
                                            'No cells'), 
                            
                            'Qualitative Description' = c('Largest improvements in bias and
                                                      precision using NM = 7 with \\textit{N} $\\ge$ 200 or
                                                      NM = 9 with \\textit{N} $\\le$ 100', 
                                                      
                                                       'Largest improvements in bias and
                                                      precision using NM = 7 with \\textit{N} $\\ge$ 200 or
                                                      NM = 9 with \\textit{N} $\\le$ 100',
                                                      
                                                     'Largest improvements in bias and
                                                      precision using NM = 7 with \\textit{N} $\\ge$ 200 or
                                                      NM = 9 with \\textit{N} $\\le$ 100',
                                                      
                                                      
                                                      'Largest improvements in bias and precision with NM = 5'), 
                            
                           
                            '$\\upbeta_{fixed}$' = beta_fixed_errorbar_lengths, 
                            '$\\upgamma_{fixed}$' = gamma_fixed_errorbar_lengths, 
                            '$\\upbeta_{random}$' = beta_rand_errorbar_lengths, 
                            '$\\upgamma_{random}$' = gamma_rand_errorbar_lengths, 
                            
                            
                            check.names = F)

kbl(x = summary_table, format = 'latex', 
linesep = c('\\cmidrule{1-8}', '\\cmidrule{1-8}', '\\cmidrule{1-8}'), 
       longtable = T, booktabs = T, centering = F, escape = F,
   align = c('l', 'l', 'l', 'l', 'c', 'c', 'c', 'c'), 
    caption = 'Concise Summary of Results Across All Spacing Schedule Levels in Experiment 2') %>%
  
     #header
  column_spec(column = 1, width = '5.5cm') %>%
  column_spec(column = 2, width = '4.5cm') %>%
  column_spec(column = 3, width = '2cm') %>%
  column_spec(column = 4, width = '5.5cm') %>%
  column_spec(column = 5:8, width = '1cm') %>%
  add_header_above(header = c(' ' = 4, 'Error Bar Summary' = 4)) %>%
  kable_styling(position = 'left') %>%

  #footnotes
  footnote(escape = F, threeparttable = T, general_title = '',
           general = "\\\\textit{Note. }`Qualitative Description' column indicates the number of measurements that result in the greatest improvements in bias and precision across all day-unit parameters. `Error Bar Summary' columns list the longest error bar lengths that result for each day-unit parameter using the measurement number/sample size pairing listed in the `Qualitative Description' column. Parameter names and population values are as follows: $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter = 180; $\\\\upgamma_{fixed}$ = fixed-effect triquarter-halfway delta parameter = 20; $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter = 10; $\\\\upgamma_{random}$ = random-effect triquarter-halfway delta parameter = 4. \\\\textit{N} = sample size, NM = number of measurements.") %>%
  landscape(margin = '2.47cm')

```

* time-interval increasing: five measurements with *N* $\ge$ 500, seven measurements with *N* $\ge$ 200 or nine measurements with *N* $\le$ 200. 
* time-interval decreasing: five measurements with *N* $\ge$ 500, seven measurements with *N* $\ge$ 200 or nine measurements with *N* $\le$ 200. 
* middle-and-extreme: five measurements with any manipulated sample size. 

\noindent Because each spacing schedule obtains comparable model performance as indicated by the similar error bar lengths, two statements can be made. First, using either seven measurements with *N* $\ge$ 200 or nine measurements with *N* $\le$ 100 with any spacing schedule except middle-and-extreme spacing results in similar model performance. Second, although only five measurements  are needed with middle-and-extreme spacing to obtain model performance that the other spacing schedules obtain with seven (at least) measurements, this result is largely a result of the nature of change that was used. In Experiment 2, the nature-of-change value that was used was 180. As noted from the results of Experiment 1, middle-and-extreme spacing resulted in the highest model performance with a nature-of-change value of 80 (see section discussing [measurement spacing](#meas-placing)). Thus, the result here that middle-and-extreme spacing results in the highest model performance is an expected given that the nature-of-change value used in Experiment 2 was fixed to 180 (see [constants](#constants-exp2)). 

The results of Experiment 2 are the first (to my knowledge) to provide measurement number and sample size guidelines for researchers interested in using nonlinear functions to model nonlinear change. Although previous simulation studies have investigated how to accurately model nonlinear change, three characteristics limit these results. First, some studies investigated the issue with fixed-effects models [e.g., @finch2017]. Given that researchers often model effects as random, findings with fixed-effects effects models are limited in their application. Second, some studies used linear functions to model nonlinear change [e.g., @fine2019; @liu2022]. Given that the parameters of linear functions become uninterpretable when modelling nonlinear change (with the intercept parameter being an exception), these models are less useful to practitioners. Third, some studies implemented unrealistic model fitting procedures by dropping a random-effect parameter from the model each time convergence failed [@finch2017]. By dropping random-effect parameters when model convergence failed, estimation accuracy could not meaningfully evaluated for parameters because values could have been obtained with reduced or simplified models. 

In summary, the results of Experiment 2 provide measurement number/sample size guidelines for researchers interested in modelling nonlinear change. Importantly, because no measurement number-sample pairing results in unbiased and precise estimation of all the day-unit parameters, the guidelines provided by this study are only suggestions to obtain the greatest improvements in model performance. Although researchers are encouraged to use larger measurement numbers and sample sizes than suggested in the current guidelines, the improvements in model performance are likely to be incommensurate with the efforts needed to increase measurement number and sample size. 


## Summary of Experiment 2

I designed Experiment 2 to investigate the measurement number and sample size combinations needed to obtain high model performance (i.e., unbiased and precise parameter estimation) under different spacing schedules. Although no measurement number/sample size pairing results in high model performance under any spacing schedule, the greatest improvements in model performance result from using modest measurement number/sample size pairings. Specifically, the greatest improvements in model performance can be obtained using either seven measurements with *N* $\ge$ 200 or nine measurements with *N* $\le$ 100.





